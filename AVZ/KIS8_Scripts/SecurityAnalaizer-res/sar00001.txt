// SA
//$ SA
// Функция анализа
function Check : dword;
var
 i, Rating : integer;
begin
 Result := 0;
 Rating := 0;
 if not(SC_INIT) then exit;
 // В логе есть подозрительные объекты любого вида ? Если да, то исследование желательно
 if SC_SelectNode('AVZ\SuspFiles') then 
  if SC_GetItemsCount > 0 then 
   Rating := 2;
 // Проверка, есть ли маскировка объектов (каждый маскируемый дает +1 к рейтингу)
 if SC_SelectNode('AVZ\PROCESS') then 
  for i := 0 to SC_GetItemsCount-1 do 
   if StrToIntDef(SC_GetParamVal(i, 'Hidden',''), -1) > 0 then
    inc(Rating);
 if Rating > 0  then 
  Result := 2;
 if Rating > 2 then 
  Result := 3;
end;

// Функция исправления проблемы
function Fix : dword;
begin
 // Заглушка
 Result := 0; 
end;
